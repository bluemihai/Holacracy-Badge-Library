%h1 Roles and Attention Points


%table
  %thead
    %tr
      %th Role Name
      %th Filler
      %th Points
      %th Delegated
      %th Unallocated
      %th Super Circle
      %th
      %th
      %th
      %th Assign Random

  %tbody
    - @roles.each do |role|
      %tr
        %td= link_to role.name, role
        %td= role.filler.try(:short)
        %td= role.points
        %td= role.delegated
        %td= role.controlled
        %td= role.circle.try(:name)
        %td= link_to 'Show', role
        %td= link_to 'Edit', edit_role_path(role)
        %td= link_to 'Destroy', role, :method => :delete, :data => { :confirm => 'Are you sure?' }
        %td= link_to 'Assign Random', assign_role_path(role, User.random)


%h5 Who Is Overworked?
1 Attention Point = 30 minutes/week

%table
  %thead
    %tr
      %th User Name
      %th Roles
      %th Attention Points
      %th % Focus
  %tbody
    - User.role_fillers.each do |user|
      %tr
        %td= user.name
        %td= user.roles.map(&:name).join(', ')
        %td= user.attention_points
        %td.text-right= number_to_percentage(user.percent_focus * 100, precision: 1)